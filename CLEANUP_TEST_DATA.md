# Cleanup Test/Mock Data

## Overview
This guide explains how to remove test/mock data from your database to show only real-time notifications based on actual send and request operations.

## Current System Behavior

The app **already shows only real-time data** from the database:
- **Admin Notifications**: Displays all blood requests from `blood_requests` table
- **User Requests**: Shows sent/received requests for logged-in users
- **No Mock Data**: The app code doesn't generate any fake/mock notifications

## Why You See Old Notifications

If you're seeing old notifications showing "6 hours ago" or similar, it's because:
1. Test data was inserted into the database during development
2. Old requests from testing are still in the database
3. All test requests were created at the same time

## How to Clean Up

### Option 1: Run SQL Cleanup Script (Recommended)

1. Open Supabase Dashboard â†’ SQL Editor
2. Run the script in `sql/cleanup-test-data.sql`
3. This will:
   - Delete all test donors (emails with 'test' or 'example.com')
   - Delete their associated blood requests
   - Optionally remove requests older than specified period

### Option 2: Manual Database Cleanup

Run these SQL commands in Supabase:

```sql
-- Delete test blood requests
DELETE FROM blood_requests
WHERE donor_id IN (
  SELECT id FROM donors 
  WHERE email LIKE '%test%' OR email LIKE '%example.com'
);

-- Delete test donors
DELETE FROM donors
WHERE email LIKE '%test%' OR email LIKE '%example.com';
```

### Option 3: Keep Only Recent Data

To keep only requests from the last 7 days:

```sql
DELETE FROM blood_requests
WHERE created_at < NOW() - INTERVAL '7 days';
```

## After Cleanup

Once you run the cleanup:
- Only real user-created requests will appear
- New requests will show proper timestamps
- Notification counts will reflect actual pending requests
- The app will continue to work normally with real data

## Real-Time Features

The app automatically:
- Fetches new requests every 3 seconds
- Updates notification badges every 5 seconds
- Displays relative time ("5 minutes ago") for recent items
- Shows absolute timestamps for reference

## Testing After Cleanup

To verify the cleanup worked:
1. Login as admin
2. Check Notifications tab - should show only real requests
3. Create a new request from donor account
4. Verify it appears immediately in admin notifications

## Important Notes

- **Backup First**: Consider exporting your data before running cleanup scripts
- **Production Data**: Be careful not to delete legitimate user data
- **Test Accounts**: Make sure test users have identifiable emails (containing 'test' or 'example.com')
- **Real Users**: Ensure real user emails don't contain 'test' patterns

## Database Schema

Current tables:
- `blood_requests`: Stores all donation requests
- `donors`: Stores donor profiles
- `admins`: Stores admin accounts

All requests are **real-time** - no mock data is generated by the application code.
